###Paths to Domain Admins from You
MATCH (n:User {name: 'YOU@DOMAIN.COM'}), (m:Group {name: 'DOMAIN ADMINS@DOMAIN.COM'})
MATCH p = shortestPath((n)-[:MemberOf|HasSession|AdminTo|AllExtendedRights|AddMember|ForceChangePassword|GenericAll|GenericWrite|Owns|WriteDacl|WriteOwner*1..]->(m))
RETURN p

###Shortest Path from Any User to Domain Admins
MATCH (n:User), (m:Group {name: 'DOMAIN ADMINS@DOMAIN.COM'})
MATCH p = shortestPath((n)-[:MemberOf|HasSession|AdminTo|AllExtendedRights|AddMember|ForceChangePassword|GenericAll|GenericWrite|Owns|WriteDacl|WriteOwner*1..]->(m))
RETURN p LIMIT 25

## From Compromised Host
###List all privileges the compromised computer has
MATCH (c:Computer {name: "COMPROMISED_COMPUTER.DOMAIN.COM"})-[r]->(target)
RETURN c.name, type(r), target.name

###Check if it's a local admin to high-value targets
MATCH (c:Computer {name: "COMPROMISED_COMPUTER.DOMAIN.COM"})-[r:AdminTo]->(target:Computer)
RETURN c.name, target.name
